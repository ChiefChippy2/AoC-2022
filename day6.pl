$x=14-$_,$d.="(?!.{0,$x}\\$_)(.)"for 1..13;<>=~/(.)$d/;print 14+length$`
# change 14 to 4 and 13 to 3 for pt 1